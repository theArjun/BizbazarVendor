import{r as u,b as o,j as s,aU as k,a as T}from"./index.4f23c09f.js";import{u as C}from"./useDebounce.06723c1e.js";import{C as z}from"./index.cffb9cfd.js";import{I as N}from"./index.334a4467.js";import{S as D}from"./index.421566c6.js";import{D as $}from"./index.d5d17e06.js";import{l as P,C as L}from"./index.340e8250.js";import{T as S}from"./Table.7ae9acac.js";import{B as I}from"./button.0e0bb488.js";import{T as A}from"./index.afbea043.js";import{a as R}from"./ReportsApi.c3373ec4.js";import{B as x}from"./Breadcrumb.1fc5972d.js";import"./Dropdown.af716b86.js";import"./useMergedState.a9c803d6.js";import"./Overflow.1804b708.js";import"./index.04eab99a.js";import"./motion.9212238f.js";import"./isEqual.5405dd52.js";import"./PlusOutlined.1693ec3e.js";import"./index.2687a7e4.js";import"./Compact.8d51645f.js";import"./TextArea.5556322f.js";import"./statusUtils.c3240a4a.js";import"./EyeOutlined.ac35e31d.js";import"./SearchOutlined.19f92cba.js";import"./pickAttrs.08767335.js";import"./CheckOutlined.a5fb0c39.js";import"./DownOutlined.72f23fd5.js";import"./LoadingOutlined.ad18cc7b.js";import"./PurePanel.01378a58.js";import"./index.7a8128c4.js";import"./styleChecker.c75b564a.js";import"./css.d6e3059f.js";import"./Pagination.61534547.js";import"./LeftOutlined.04d83dae.js";import"./RightOutlined.dab7e2a3.js";import"./useForceUpdate.f84be2ca.js";import"./responsiveObserve.16c01648.js";import"./index.9fb36eb2.js";import"./index.48a55223.js";import"./dropdown.c5450427.js";import"./collapse.7fea9198.js";import"./useFlexGapSupport.3166aa6c.js";import"./index.c1ec313f.js";import"./apicall.3416e5db.js";import"./axios.0a901153.js";import"./config.93562c2e.js";import"./render.a21f8e67.js";import"./useNotification.ddc3cd5c.js";import"./apicall2.94c75d74.js";import"./useInfiniteQuery.esm.7b143079.js";import"./useQuery.esm.48f464b8.js";import"./utils.esm.958af8f4.js";const B="_container_1qg89_1",E={container:B},O="_container_p3h5z_1",V="_search_inputs_p3h5z_9",M="_price_container_p3h5z_21",j="_search_btn_p3h5z_55",q="_form_p3h5z_63",H="_formcolumn_p3h5z_83",U="_dropdownbutton_p3h5z_99",K="_icon_p3h5z_107",W="_flex_p3h5z_133",F="_datepicker_p3h5z_145",G="_date_p3h5z_145",J="_span_p3h5z_161",w={container:O,search_inputs:V,price_container:M,search_btn:j,form:q,formcolumn:H,dropdownbutton:U,icon:K,flex:W,datepicker:F,date:G,span:J};const{RangePicker:Q}=$,X=({params:m,setParams:d,status:h})=>{const[g,v]=u.exports.useState("");C(()=>{let r={...m};r.order_id=g,d(r)},500,[g]);const i=r=>{var f,_,l,n,a,t;let c={...m};if(r){let e=new Date((f=r[0])==null?void 0:f.$y,(_=r[0])==null?void 0:_.$M,(l=r[0])==null?void 0:l.$D).getTime()/1e3,p=new Date((n=r[1])==null?void 0:n.$y,(a=r[1])==null?void 0:a.$M,(t=r[1])==null?void 0:t.$D).getTime()/1e3;c.date=`time_from=${e}&time_to=${p}`}else c.date="test=9";d(c)};return o("div",{className:w.container,id:"changeHere",children:o(z,{children:s("div",{className:w.formcolumn,children:[s("label",{children:["Order ID",o(N,{type:"number",onChange:r=>v(r.target.value)})]}),s("label",{children:[o("div",{children:"Order Status"}),o(D,{allowClear:!0,placeholder:"Search order status",style:{width:"100%"},onChange:r=>{console.log(r);let c={...m};c.status_id=r||"",d(c)},options:h})]}),s("label",{children:["Order date: ",o("br",{}),o("div",{style:{minWidth:"250px"},children:o(Q,{onChange:r=>i(r)})})]})]})})})},Y="_product_info_sw05v_1",Z="_product_name_sw05v_9",tt="_icons_sw05v_19",et="_order_status_sw05v_51",rt="_gross_total_sw05v_59",ot="_openSpinner_sw05v_67",nt="_closeSpinner_sw05v_75",it="_positionabsolute_sw05v_83",at="_print_sw05v_95",st="_margintop_sw05v_103",y={product_info:Y,product_name:Z,icons:tt,order_status:et,gross_total:rt,openSpinner:ot,closeSpinner:nt,positionabsolute:it,print:at,margintop:st},ct=({status:m,couponData:d,loading:h})=>{const g=k(),[v,i]=u.exports.useState(!1),r=u.exports.useRef(),c=T(),f=t=>{const[e]=m.filter(p=>p.value===t);return o("div",{children:o(A,{className:y.dpContainer,color:e==null?void 0:e.color,children:e==null?void 0:e.label})})},_=t=>{const e=new Date(parseInt(t)*1e3),p=e.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),b=e.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return p+", "+b},l=[{title:"Order Id",dataIndex:"order_id",key:"status_id",render:(t,e)=>s("div",{onClick:()=>c(`/Orders/orders details/${e.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",t]}),width:140},{title:"Date And Time",dataIndex:"order_date",key:"date",render:t=>_(t)},{title:"Company name",dataIndex:"company_name",key:"company_name",render:(t,e)=>o("div",{children:t})},{title:"Customer",dataIndex:"customer",key:"customer"},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Promotion  value",dataIndex:"promotion_value",key:"promotion_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Net order value",dataIndex:"net_order_value",key:"net_order_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Promotion name",dataIndex:"promotion_value",key:"promotion_value"},{title:"Order status",dataIndex:"status_id",key:"status_id",render:t=>f(t)}],n=P.exports.useReactToPrint({content:()=>r.current,onAfterPrint:()=>i(!1)}),a=()=>{i(!0);const t=setTimeout(n,10);return()=>clearTimeout(t)};return s("div",{children:[o(S,{id:"reportaccount",columns:l,rowKey:"order_id",loading:h,dataSource:d,pagination:!1,scroll:{y:g.height>670?500:300,x:1800}}),s("div",{className:y.positionabsolute,children:[o(I,{className:y.print,onClick:a,children:"print"}),o(I,{children:o(L,{filename:"Expense_Table.csv",data:d,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),v&&o("div",{className:y.margintop}),v&&o(S,{id:"reporprintTableaccount1",className:y.printTable,style:{zIndex:-1},columns:l,ref:r,rowKey:"order_id",dataSource:d,pagination:!1})]})},dt={order_id:"",date:"",status_id:"",page:1},de=()=>{const[m,d]=u.exports.useState(dt),[h,g]=u.exports.useState(!1),{isLoading:v,data:i,isFetchingNextPage:r,fetchNextPage:c}=R(m);u.exports.useEffect(()=>{var n;return(n=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||n.addEventListener("scroll",l),()=>{var a;(a=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||a.removeEventListener("scroll",l)}},[]);let f=u.exports.useMemo(()=>{var a;let n=[];return(a=i==null?void 0:i.pages)==null||a.map(t=>{var e,p;(p=(e=t==null?void 0:t.data)==null?void 0:e.report)==null||p.map(b=>{n.push(b)})}),n||[]},[i]);const _=()=>{var n,a;if(i!=null&&i.pages){let t=[...(a=(n=i==null?void 0:i.pages)==null?void 0:n.at(-1).data)==null?void 0:a.order_status];return t==null?void 0:t.map((e,p)=>{var b;return{label:e==null?void 0:e.description,value:e==null?void 0:e.status_id,color:(b=e==null?void 0:e.params)==null?void 0:b.color}})}return[]},l=n=>{const a=n.target.scrollTop+n.target.offsetHeight+100>n.target.scrollHeight;g(a)};return C(()=>{!h||c()},300,[h]),s("div",{className:E.container,children:[s(x,{children:[o(x.Item,{children:"Reports"}),o(x.Item,{children:"Coupon Voucher Reports"})]}),o(X,{params:m,setParams:d,status:_()}),o(ct,{couponData:f,status:_(),loading:v||r})]})};export{de as default};
