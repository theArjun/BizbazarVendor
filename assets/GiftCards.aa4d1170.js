import{r as h,b as r,j as a,aU as I,a as T}from"./index.559c1fcf.js";import{u as D}from"./useDebounce.34ba1d43.js";import{C as $}from"./index.4fb68f20.js";import{I as k}from"./index.99653d62.js";import{D as N}from"./index.8ee90bcc.js";import{l as G,C as P}from"./index.3d1dbc4d.js";import{T as x}from"./Table.382eff90.js";import{B as S}from"./button.c49f6243.js";import{d as L}from"./ReportsApi.9fa071a0.js";import{B as y}from"./Breadcrumb.a0c48c79.js";import"./Dropdown.40e49efe.js";import"./useMergedState.e59004d6.js";import"./Overflow.0ae650b7.js";import"./index.800256bd.js";import"./motion.c94e2116.js";import"./isEqual.5b0c1f76.js";import"./PlusOutlined.c65b7533.js";import"./index.e42cc673.js";import"./Compact.e0a86bbb.js";import"./TextArea.8f7e52a8.js";import"./statusUtils.8e955008.js";import"./EyeOutlined.acaf92f0.js";import"./SearchOutlined.1243ca95.js";import"./PurePanel.4b452415.js";import"./index.02299b94.js";import"./pickAttrs.09e8e693.js";import"./styleChecker.3de124d5.js";import"./css.d6e3059f.js";import"./index.57a1466e.js";import"./CheckOutlined.61030fcd.js";import"./DownOutlined.218b67e6.js";import"./LoadingOutlined.65af6f9d.js";import"./Pagination.76f30899.js";import"./LeftOutlined.abb276d5.js";import"./RightOutlined.6508ce6f.js";import"./useForceUpdate.3743a744.js";import"./responsiveObserve.0df24820.js";import"./index.7376aa48.js";import"./index.23768e3e.js";import"./dropdown.496de808.js";import"./collapse.4ef0eee8.js";import"./useFlexGapSupport.39a8fd32.js";import"./index.2534c696.js";import"./apicall.a45120ef.js";import"./axios.0a901153.js";import"./config.d6ac9ea8.js";import"./render.6e9f9fbc.js";import"./useNotification.530e6546.js";import"./apicall2.9b40c9fc.js";import"./useInfiniteQuery.esm.273cbf80.js";import"./useQuery.esm.484a4dde.js";import"./utils.esm.f9fc2da8.js";const R="_container_1qg89_1",A={container:R},M="_container_178h8_1",U="_search_inputs_178h8_9",B="_price_container_178h8_21",E="_search_btn_178h8_55",j="_form_178h8_63",q="_formcolumn_178h8_83",z="_dropdownbutton_178h8_101",H="_icon_178h8_109",O="_flex_178h8_135",K="_datepicker_178h8_147",V="_date_178h8_147",F="_span_178h8_163",w={container:M,search_inputs:U,price_container:B,search_btn:E,form:j,formcolumn:q,dropdownbutton:z,icon:H,flex:O,datepicker:K,date:V,span:F};const{RangePicker:C}=N,W=({params:c,setParams:u})=>{const[p,b]=h.exports.useState([]);D(()=>{let t={...c};t.gift_card_number=p,u(t)},500,[p]);const d=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.issued_time_from=l,n.issued_time_from=f}else n.issued_time_from="",n.issued_time_to="";u(n)},g=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.used_time_from=l,n.used_time_to=f}else n.used_time_from="",n.used_time_to="";u(n)};return r("div",{className:w.container,id:"changeHere",children:r($,{children:a("div",{className:w.formcolumn,children:[a("label",{children:["Gift Card Number",r(k,{onChange:t=>b(t.target.value)})]}),a("label",{children:["Gift Card Issue Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>d(t)})})]}),a("label",{children:["Gift Card Used Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>g(t)})})]})]})})})},J="_product_info_sw05v_1",Q="_product_name_sw05v_9",X="_icons_sw05v_19",Y="_order_status_sw05v_51",Z="_gross_total_sw05v_59",tt="_openSpinner_sw05v_67",et="_closeSpinner_sw05v_75",rt="_positionabsolute_sw05v_83",ot="_print_sw05v_95",nt="_margintop_sw05v_103",v={product_info:J,product_name:Q,icons:X,order_status:Y,gross_total:Z,openSpinner:tt,closeSpinner:et,positionabsolute:rt,print:ot,margintop:nt},it=({giftData:c,loading:u,handleScroll:p})=>{const b=I(),[d,g]=h.exports.useState(!1),t=h.exports.useRef(),n=T();h.exports.useEffect(()=>{var e;return(e=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||e.addEventListener("scroll",p),()=>{var o;(o=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||o.removeEventListener("scroll",p)}},[]);const _=e=>{const o=new Date(parseInt(e)*1e3),l=o.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),f=o.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return l+", "+f},m=[{title:"Used date",dataIndex:"used_date",key:"order_id",render:e=>_(e)},{title:"Customer email",dataIndex:"email",key:"email",render:(e,o)=>r("a",{children:e})},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Order ID",dataIndex:"order_id",render:(e,o)=>a("div",{onClick:()=>n(`/Orders/orders details/${o.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",e]})},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card amount used",dataIndex:"gift_card_amount_used",key:"gift_card_amount_used",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card number",dataIndex:"gift_card_number",key:"gift_card_number",render:(e,o)=>r("a",{children:e})}],i=G.exports.useReactToPrint({content:()=>t.current,onAfterPrint:()=>g(!1)}),s=()=>{g(!0);const e=setTimeout(i,10);return()=>clearTimeout(e)};return a("div",{children:[r(x,{id:"reportaccount",columns:m,rowKey:"order_id",loading:u,dataSource:c,pagination:!1,scroll:{y:b.height>670?500:300,x:1200}}),a("div",{className:v.positionabsolute,children:[r(S,{className:v.print,onClick:s,children:"print"}),r(S,{children:r(P,{filename:"Gift_Cards.csv",data:c,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),d&&r("div",{className:v.margintop}),d&&r(x,{id:"reporprintTableaccount1",className:v.printTable,style:{zIndex:-1},columns:m,ref:t,rowKey:"order_id",dataSource:c,pagination:!1})]})},st={gift_card_number:"",issued_time_from:"",issued_time_to:"",used_time_from:"",used_time_to:""},ie=()=>{const[c,u]=h.exports.useState(st),[p,b]=h.exports.useState(!1),{data:d,isLoading:g,isFetchingNextPage:t,fetchNextPage:n}=L(c),_=i=>{const s=i.target.scrollTop+i.target.offsetHeight+100>i.target.scrollHeight;b(s)};let m=h.exports.useMemo(()=>{var s;let i=[];return(s=d==null?void 0:d.pages)==null||s.map(e=>{var o,l;(l=(o=e==null?void 0:e.data)==null?void 0:o.report)==null||l.map(f=>{i.push(f)})}),i||[]},[d]);return D(()=>{!p||n()},300,[p]),a("div",{className:A.container,children:[a(y,{children:[r(y.Item,{children:"Reports"}),r(y.Item,{children:"Gift Cards"})]}),r(W,{params:c,setParams:u}),r(it,{giftData:m,loading:g||t,handleScroll:_})]})};export{ie as default};
