import{r as h,b as r,j as a,aU as I,a as T}from"./index.0eae6df2.js";import{u as D}from"./useDebounce.2d8db3a6.js";import{C as $}from"./index.1b605c09.js";import{I as k}from"./index.e0155dc4.js";import{D as N}from"./index.6310553a.js";import{l as G,C as P}from"./index.6a329b30.js";import{T as x}from"./Table.c3ea0e52.js";import{B as S}from"./button.bb92e4e7.js";import{d as L}from"./ReportsApi.48b17fc7.js";import{B as y}from"./Breadcrumb.3e55c3b1.js";import"./Dropdown.a44dcf86.js";import"./useMergedState.e128dcb1.js";import"./Overflow.0bb1c80c.js";import"./index.00b7436e.js";import"./motion.25de7d91.js";import"./isEqual.7557051f.js";import"./PlusOutlined.bcf114a1.js";import"./index.ae11ed19.js";import"./Compact.394e1fff.js";import"./TextArea.79f23aac.js";import"./statusUtils.bdd687b0.js";import"./EyeOutlined.e2533ce1.js";import"./SearchOutlined.83cc36da.js";import"./PurePanel.6b30b4ea.js";import"./index.a53e5976.js";import"./pickAttrs.8c22c2db.js";import"./styleChecker.c2755425.js";import"./css.d6e3059f.js";import"./index.c17da8cc.js";import"./CheckOutlined.aebd02a2.js";import"./DownOutlined.0d88a6a7.js";import"./LoadingOutlined.8c764613.js";import"./Pagination.e850c34f.js";import"./LeftOutlined.3acbf618.js";import"./RightOutlined.44374471.js";import"./useForceUpdate.36181d63.js";import"./responsiveObserve.b22e885b.js";import"./index.db80b566.js";import"./index.ed0030b1.js";import"./dropdown.04f8b523.js";import"./collapse.d7e28f1d.js";import"./useFlexGapSupport.26f67e3e.js";import"./index.7079f3c0.js";import"./apicall.28ee9ed9.js";import"./axios.0a901153.js";import"./config.a608364a.js";import"./render.36f71972.js";import"./useNotification.b0fd12ef.js";import"./apicall2.1308aa4e.js";import"./useInfiniteQuery.esm.39b60b71.js";import"./useQuery.esm.a226e4a2.js";import"./utils.esm.9d23a50b.js";const R="_container_1qg89_1",A={container:R},M="_container_178h8_1",U="_search_inputs_178h8_9",B="_price_container_178h8_21",E="_search_btn_178h8_55",j="_form_178h8_63",q="_formcolumn_178h8_83",z="_dropdownbutton_178h8_101",H="_icon_178h8_109",O="_flex_178h8_135",K="_datepicker_178h8_147",V="_date_178h8_147",F="_span_178h8_163",w={container:M,search_inputs:U,price_container:B,search_btn:E,form:j,formcolumn:q,dropdownbutton:z,icon:H,flex:O,datepicker:K,date:V,span:F};const{RangePicker:C}=N,W=({params:c,setParams:u})=>{const[p,b]=h.exports.useState([]);D(()=>{let t={...c};t.gift_card_number=p,u(t)},500,[p]);const d=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.issued_time_from=l,n.issued_time_from=f}else n.issued_time_from="",n.issued_time_to="";u(n)},g=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.used_time_from=l,n.used_time_to=f}else n.used_time_from="",n.used_time_to="";u(n)};return r("div",{className:w.container,id:"changeHere",children:r($,{children:a("div",{className:w.formcolumn,children:[a("label",{children:["Gift Card Number",r(k,{onChange:t=>b(t.target.value)})]}),a("label",{children:["Gift Card Issue Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>d(t)})})]}),a("label",{children:["Gift Card Used Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>g(t)})})]})]})})})},J="_product_info_sw05v_1",Q="_product_name_sw05v_9",X="_icons_sw05v_19",Y="_order_status_sw05v_51",Z="_gross_total_sw05v_59",tt="_openSpinner_sw05v_67",et="_closeSpinner_sw05v_75",rt="_positionabsolute_sw05v_83",ot="_print_sw05v_95",nt="_margintop_sw05v_103",v={product_info:J,product_name:Q,icons:X,order_status:Y,gross_total:Z,openSpinner:tt,closeSpinner:et,positionabsolute:rt,print:ot,margintop:nt},it=({giftData:c,loading:u,handleScroll:p})=>{const b=I(),[d,g]=h.exports.useState(!1),t=h.exports.useRef(),n=T();h.exports.useEffect(()=>{var e;return(e=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||e.addEventListener("scroll",p),()=>{var o;(o=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||o.removeEventListener("scroll",p)}},[]);const _=e=>{const o=new Date(parseInt(e)*1e3),l=o.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),f=o.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return l+", "+f},m=[{title:"Used date",dataIndex:"used_date",key:"order_id",render:e=>_(e)},{title:"Customer email",dataIndex:"email",key:"email",render:(e,o)=>r("a",{children:e})},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Order ID",dataIndex:"order_id",render:(e,o)=>a("div",{onClick:()=>n(`/Orders/orders details/${o.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",e]})},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card amount used",dataIndex:"gift_card_amount_used",key:"gift_card_amount_used",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card number",dataIndex:"gift_card_number",key:"gift_card_number",render:(e,o)=>r("a",{children:e})}],i=G.exports.useReactToPrint({content:()=>t.current,onAfterPrint:()=>g(!1)}),s=()=>{g(!0);const e=setTimeout(i,10);return()=>clearTimeout(e)};return a("div",{children:[r(x,{id:"reportaccount",columns:m,rowKey:"order_id",loading:u,dataSource:c,pagination:!1,scroll:{y:b.height>670?500:300,x:1200}}),a("div",{className:v.positionabsolute,children:[r(S,{className:v.print,onClick:s,children:"print"}),r(S,{children:r(P,{filename:"Gift_Cards.csv",data:c,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),d&&r("div",{className:v.margintop}),d&&r(x,{id:"reporprintTableaccount1",className:v.printTable,style:{zIndex:-1},columns:m,ref:t,rowKey:"order_id",dataSource:c,pagination:!1})]})},st={gift_card_number:"",issued_time_from:"",issued_time_to:"",used_time_from:"",used_time_to:""},ie=()=>{const[c,u]=h.exports.useState(st),[p,b]=h.exports.useState(!1),{data:d,isLoading:g,isFetchingNextPage:t,fetchNextPage:n}=L(c),_=i=>{const s=i.target.scrollTop+i.target.offsetHeight+100>i.target.scrollHeight;b(s)};let m=h.exports.useMemo(()=>{var s;let i=[];return(s=d==null?void 0:d.pages)==null||s.map(e=>{var o,l;(l=(o=e==null?void 0:e.data)==null?void 0:o.report)==null||l.map(f=>{i.push(f)})}),i||[]},[d]);return D(()=>{!p||n()},300,[p]),a("div",{className:A.container,children:[a(y,{children:[r(y.Item,{children:"Reports"}),r(y.Item,{children:"Gift Cards"})]}),r(W,{params:c,setParams:u}),r(it,{giftData:m,loading:g||t,handleScroll:_})]})};export{ie as default};
