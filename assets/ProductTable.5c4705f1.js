import{r as h,ao as j,a as K,aU as Q,j as a,b as o}from"./index.559c1fcf.js";import{j as H,k as z,a as U}from"./index.esm.267eb871.js";import{h as V,i as X,j as J}from"./ProductApi.fe19781a.js";import{T as d}from"./Table.382eff90.js";import{B as W}from"./button.c49f6243.js";import{I as G}from"./index.53d3f337.js";import{D as v,S as Y}from"./dropdown.496de808.js";import{M as Z}from"./index.e5e0e49c.js";import{T as s}from"./index.390b8a49.js";import"./apiConfig.819e96ae.js";import"./axios.0a901153.js";import"./config.d6ac9ea8.js";import"./render.6e9f9fbc.js";import"./useNotification.530e6546.js";import"./useMutation.esm.3622c9ad.js";import"./utils.esm.f9fc2da8.js";import"./useInfiniteQuery.esm.273cbf80.js";import"./useQuery.esm.484a4dde.js";import"./motion.c94e2116.js";import"./isEqual.5b0c1f76.js";import"./useMergedState.e59004d6.js";import"./pickAttrs.09e8e693.js";import"./styleChecker.3de124d5.js";import"./index.800256bd.js";import"./css.d6e3059f.js";import"./index.57a1466e.js";import"./Overflow.0ae650b7.js";import"./statusUtils.8e955008.js";import"./CheckOutlined.61030fcd.js";import"./DownOutlined.218b67e6.js";import"./LoadingOutlined.65af6f9d.js";import"./SearchOutlined.1243ca95.js";import"./PurePanel.4b452415.js";import"./Compact.e0a86bbb.js";import"./Pagination.76f30899.js";import"./LeftOutlined.abb276d5.js";import"./RightOutlined.6508ce6f.js";import"./useForceUpdate.3743a744.js";import"./responsiveObserve.0df24820.js";import"./index.e42cc673.js";import"./index.7376aa48.js";import"./index.23768e3e.js";import"./index.2534c696.js";import"./collapse.4ef0eee8.js";import"./index.99653d62.js";import"./TextArea.8f7e52a8.js";import"./EyeOutlined.acaf92f0.js";import"./index.02299b94.js";import"./index.38297928.js";import"./Dropdown.40e49efe.js";import"./useFlexGapSupport.39a8fd32.js";const $="_product_info_1tgvq_1",ee="_product_name_1tgvq_9",te="_icons_1tgvq_19",oe="_openDelete_1tgvq_51",re="_selectBar_1tgvq_57",c={product_info:$,product_name:ee,icons:te,openDelete:oe,selectBar:re},{confirm:ie}=Z,ot=({loading:S,handleScroll:l,setSortBy:k,products:b})=>{const[n,f]=h.exports.useState(""),[u,p]=h.exports.useState([]),{mutate:C,isLoading:x}=V(),{mutate:D,isLoading:I}=X(),{mutate:E,isLoading:N}=J(),m=j(),_=K(),A=Q();h.exports.useEffect(()=>{var t;return(t=document.querySelector("#product > div > div.ant-table-body"))==null||t.addEventListener("scroll",l),()=>{var e;(e=document.querySelector("#product > div > div.ant-table-body"))==null||e.removeEventListener("scroll",l)}},[l]);function L(t,e="",r){ie({title:t,content:e,async onOk(){try{C(r,{onSuccess:i=>{m.invalidateQueries(["products"])}})}catch{return console.log("Oops errors!")}},onCancel(){}})}const R=async t=>{let e={product_ids:{}};t==null||t.map((r,i)=>{e.product_ids[i]=r}),D(e,{onSuccess:r=>{m.invalidateQueries(["products"])}})},q=async(t,e)=>{f(t),window.localstorage.setItem("productRowId",JSON.stringify(t)),e==="detail"&&_("products")},g=(t,e)=>{E({id:t,status:e},{onSuccess:r=>{m.invalidateQueries(["products"])}})},y=t=>{switch(t){case"H":return o(s,{color:"purple",children:"Hidden"});case"A":return o(s,{color:"green",children:"Active"});case"D":return o(s,{color:"orange",children:"Disabled"});case"R":return o(s,{color:"red",children:"Requires Approval"});case"X":return o(s,{color:"magenta",children:"Disapproved"});default:return"Attention required"}},w=[{key:"1",label:o("div",{onClick:()=>g(n,"A"),children:"Active"})},{key:"2",label:o("div",{onClick:()=>g(n,"D"),children:"Disabled"})},{key:"3",label:o("div",{onClick:()=>g(n,"H"),children:"Hidden"})}],O=[{key:"1",label:a("a",{onClick:()=>_("../products/"+n),children:["Edit ",o(H,{})]})},{key:"2",label:a("a",{rel:"noopener noreferrer",href:"#",className:c.action_items,onClick:()=>L("Are you sure to delete?","",n),children:["Delete",o(z,{})]})}],P=[{title:"Name/Code",dataIndex:["product_id","product","product_code","main_pair"],data:"data",key:"product",render:(t,e)=>{var r;return a("div",{className:c.product_info,children:[o(G,{width:70,src:e.main_pair?e.main_pair.detailed.image_path:"",alt:""}),a("div",{className:c.product_name,children:[o("a",{onClick:()=>_("../products/"+(e==null?void 0:e.product_id)),children:o("strong",{children:((r=e.product)==null?void 0:r.length)>15?e.product.substring(0,15)+"...":e.product})}),o("small",{children:e.product_code})]})]})},sorter:(t,e)=>{}},{title:"Price",dataIndex:"price",key:"price",sorter:(t,e)=>{},render:t=>o("p",{children:parseFloat(t).toFixed(2)})},{title:"Quantity",dataIndex:"amount",key:"amount",sorter:(t,e)=>{}},{title:"Action",key:"action",dataIndex:["product_id"],render:t=>o("div",{className:c.product_action,onClick:()=>q(t),children:o(v,{menu:{items:O},placement:"bottom",arrow:!0,trigger:["click"],children:o(U,{size:20,className:c.icons})})})},{title:"Status",key:"status",dataIndex:["status","product_id"],defaultFilteredValue:"Requires Approval",render:(t,e)=>o("div",{children:e.status=="R"||e.status=="X"?y(e.status):o(v,{menu:{items:w},children:o(Y,{onMouseOver:()=>f(e.product_id),children:y(e.status)})})})}],T=t=>{p(t)},B=u.length>0,F={selectedRowKeys:u,onChange:T,selections:[d.SELECTION_ALL,d.SELECTION_INVERT,d.SELECTION_NONE,{key:"odd",text:"Select Odd Row",onSelect:t=>{let e=[];e=t.filter((r,i)=>i%2===0),p(e)}},{key:"even",text:"Select Even Row",onSelect:t=>{let e=[];e=t.filter((r,i)=>i%2!==0),p(e)}}]};function M(t,e,r,i){k(r)}return a("div",{children:[o("div",{style:{backgroundColor:"white",padding:"10px"},children:o(W,{type:"primary",onClick:()=>R(u),disabled:!B,children:"Delete"})}),o(d,{id:"product",rowKey:"product_id",loading:S||x||I||N,rowSelection:F,columns:P,dataSource:b,pagination:!1,onChange:M,scroll:{y:A.height>670?400:200,x:1e3}})]})};export{ot as default};
