import{r as h,b as r,j as a,aU as I,a as T}from"./index.2fea9b70.js";import{u as D}from"./useDebounce.857d1c38.js";import{C as $}from"./index.576a1fa8.js";import{I as k}from"./index.d50c1940.js";import{D as N}from"./index.af8ebb03.js";import{l as G,C as P}from"./index.e80757bf.js";import{T as x}from"./Table.7ec01c5e.js";import{B as S}from"./button.8d7ffa1a.js";import{d as L}from"./ReportsApi.f602d7ab.js";import{B as y}from"./Breadcrumb.37de7763.js";import"./Dropdown.1d3385b2.js";import"./useMergedState.acd959e8.js";import"./Overflow.1e0ec03a.js";import"./index.f5b4f9b0.js";import"./motion.cd9ea6a7.js";import"./isEqual.cc883666.js";import"./PlusOutlined.f1c18f31.js";import"./index.90d07be9.js";import"./Compact.c7a1bef5.js";import"./TextArea.38af062b.js";import"./statusUtils.ab87837f.js";import"./EyeOutlined.b9911e82.js";import"./SearchOutlined.3b0489e1.js";import"./PurePanel.7897ccec.js";import"./index.de03715e.js";import"./pickAttrs.18ca283f.js";import"./styleChecker.9361c740.js";import"./css.d6e3059f.js";import"./index.5de7cfda.js";import"./CheckOutlined.45292deb.js";import"./DownOutlined.653e5bd2.js";import"./LoadingOutlined.3aeec88a.js";import"./Pagination.75c29296.js";import"./LeftOutlined.67edc2db.js";import"./RightOutlined.19164f95.js";import"./useForceUpdate.997a6267.js";import"./responsiveObserve.6b5848d4.js";import"./index.60d0402b.js";import"./index.11d6766c.js";import"./dropdown.0343149c.js";import"./collapse.3b35c5c9.js";import"./useFlexGapSupport.a59bf389.js";import"./index.171e0a82.js";import"./apicall.7005afb3.js";import"./axios.0a901153.js";import"./config.42e56451.js";import"./render.a8adff37.js";import"./useNotification.7663c963.js";import"./apicall2.997ebd5b.js";import"./useInfiniteQuery.esm.f9f05d77.js";import"./useQuery.esm.8aa31306.js";import"./utils.esm.061cfd12.js";const R="_container_1qg89_1",A={container:R},M="_container_178h8_1",U="_search_inputs_178h8_9",B="_price_container_178h8_21",E="_search_btn_178h8_55",j="_form_178h8_63",q="_formcolumn_178h8_83",z="_dropdownbutton_178h8_101",H="_icon_178h8_109",O="_flex_178h8_135",K="_datepicker_178h8_147",V="_date_178h8_147",F="_span_178h8_163",w={container:M,search_inputs:U,price_container:B,search_btn:E,form:j,formcolumn:q,dropdownbutton:z,icon:H,flex:O,datepicker:K,date:V,span:F};const{RangePicker:C}=N,W=({params:c,setParams:u})=>{const[p,b]=h.exports.useState([]);D(()=>{let t={...c};t.gift_card_number=p,u(t)},500,[p]);const d=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.issued_time_from=l,n.issued_time_from=f}else n.issued_time_from="",n.issued_time_to="";u(n)},g=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.used_time_from=l,n.used_time_to=f}else n.used_time_from="",n.used_time_to="";u(n)};return r("div",{className:w.container,id:"changeHere",children:r($,{children:a("div",{className:w.formcolumn,children:[a("label",{children:["Gift Card Number",r(k,{onChange:t=>b(t.target.value)})]}),a("label",{children:["Gift Card Issue Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>d(t)})})]}),a("label",{children:["Gift Card Used Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>g(t)})})]})]})})})},J="_product_info_sw05v_1",Q="_product_name_sw05v_9",X="_icons_sw05v_19",Y="_order_status_sw05v_51",Z="_gross_total_sw05v_59",tt="_openSpinner_sw05v_67",et="_closeSpinner_sw05v_75",rt="_positionabsolute_sw05v_83",ot="_print_sw05v_95",nt="_margintop_sw05v_103",v={product_info:J,product_name:Q,icons:X,order_status:Y,gross_total:Z,openSpinner:tt,closeSpinner:et,positionabsolute:rt,print:ot,margintop:nt},it=({giftData:c,loading:u,handleScroll:p})=>{const b=I(),[d,g]=h.exports.useState(!1),t=h.exports.useRef(),n=T();h.exports.useEffect(()=>{var e;return(e=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||e.addEventListener("scroll",p),()=>{var o;(o=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||o.removeEventListener("scroll",p)}},[]);const _=e=>{const o=new Date(parseInt(e)*1e3),l=o.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),f=o.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return l+", "+f},m=[{title:"Used date",dataIndex:"used_date",key:"order_id",render:e=>_(e)},{title:"Customer email",dataIndex:"email",key:"email",render:(e,o)=>r("a",{children:e})},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Order ID",dataIndex:"order_id",render:(e,o)=>a("div",{onClick:()=>n(`/Orders/orders details/${o.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",e]})},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card amount used",dataIndex:"gift_card_amount_used",key:"gift_card_amount_used",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card number",dataIndex:"gift_card_number",key:"gift_card_number",render:(e,o)=>r("a",{children:e})}],i=G.exports.useReactToPrint({content:()=>t.current,onAfterPrint:()=>g(!1)}),s=()=>{g(!0);const e=setTimeout(i,10);return()=>clearTimeout(e)};return a("div",{children:[r(x,{id:"reportaccount",columns:m,rowKey:"order_id",loading:u,dataSource:c,pagination:!1,scroll:{y:b.height>670?500:300,x:1200}}),a("div",{className:v.positionabsolute,children:[r(S,{className:v.print,onClick:s,children:"print"}),r(S,{children:r(P,{filename:"Gift_Cards.csv",data:c,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),d&&r("div",{className:v.margintop}),d&&r(x,{id:"reporprintTableaccount1",className:v.printTable,style:{zIndex:-1},columns:m,ref:t,rowKey:"order_id",dataSource:c,pagination:!1})]})},st={gift_card_number:"",issued_time_from:"",issued_time_to:"",used_time_from:"",used_time_to:""},ie=()=>{const[c,u]=h.exports.useState(st),[p,b]=h.exports.useState(!1),{data:d,isLoading:g,isFetchingNextPage:t,fetchNextPage:n}=L(c),_=i=>{const s=i.target.scrollTop+i.target.offsetHeight+100>i.target.scrollHeight;b(s)};let m=h.exports.useMemo(()=>{var s;let i=[];return(s=d==null?void 0:d.pages)==null||s.map(e=>{var o,l;(l=(o=e==null?void 0:e.data)==null?void 0:o.report)==null||l.map(f=>{i.push(f)})}),i||[]},[d]);return D(()=>{!p||n()},300,[p]),a("div",{className:A.container,children:[a(y,{children:[r(y.Item,{children:"Reports"}),r(y.Item,{children:"Gift Cards"})]}),r(W,{params:c,setParams:u}),r(it,{giftData:m,loading:g||t,handleScroll:_})]})};export{ie as default};
