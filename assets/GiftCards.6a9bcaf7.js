import{r as h,b as r,j as a,aU as I,a as T}from"./index.4f23c09f.js";import{u as D}from"./useDebounce.06723c1e.js";import{C as $}from"./index.cffb9cfd.js";import{I as k}from"./index.334a4467.js";import{D as N}from"./index.d5d17e06.js";import{l as G,C as P}from"./index.340e8250.js";import{T as x}from"./Table.7ae9acac.js";import{B as S}from"./button.0e0bb488.js";import{d as L}from"./ReportsApi.c3373ec4.js";import{B as y}from"./Breadcrumb.1fc5972d.js";import"./Dropdown.af716b86.js";import"./useMergedState.a9c803d6.js";import"./Overflow.1804b708.js";import"./index.04eab99a.js";import"./motion.9212238f.js";import"./isEqual.5405dd52.js";import"./PlusOutlined.1693ec3e.js";import"./index.2687a7e4.js";import"./Compact.8d51645f.js";import"./TextArea.5556322f.js";import"./statusUtils.c3240a4a.js";import"./EyeOutlined.ac35e31d.js";import"./SearchOutlined.19f92cba.js";import"./PurePanel.01378a58.js";import"./index.7a8128c4.js";import"./pickAttrs.08767335.js";import"./styleChecker.c75b564a.js";import"./css.d6e3059f.js";import"./index.421566c6.js";import"./CheckOutlined.a5fb0c39.js";import"./DownOutlined.72f23fd5.js";import"./LoadingOutlined.ad18cc7b.js";import"./Pagination.61534547.js";import"./LeftOutlined.04d83dae.js";import"./RightOutlined.dab7e2a3.js";import"./useForceUpdate.f84be2ca.js";import"./responsiveObserve.16c01648.js";import"./index.9fb36eb2.js";import"./index.48a55223.js";import"./dropdown.c5450427.js";import"./collapse.7fea9198.js";import"./useFlexGapSupport.3166aa6c.js";import"./index.c1ec313f.js";import"./apicall.3416e5db.js";import"./axios.0a901153.js";import"./config.93562c2e.js";import"./render.a21f8e67.js";import"./useNotification.ddc3cd5c.js";import"./apicall2.94c75d74.js";import"./useInfiniteQuery.esm.7b143079.js";import"./useQuery.esm.48f464b8.js";import"./utils.esm.958af8f4.js";const R="_container_1qg89_1",A={container:R},M="_container_178h8_1",U="_search_inputs_178h8_9",B="_price_container_178h8_21",E="_search_btn_178h8_55",j="_form_178h8_63",q="_formcolumn_178h8_83",z="_dropdownbutton_178h8_101",H="_icon_178h8_109",O="_flex_178h8_135",K="_datepicker_178h8_147",V="_date_178h8_147",F="_span_178h8_163",w={container:M,search_inputs:U,price_container:B,search_btn:E,form:j,formcolumn:q,dropdownbutton:z,icon:H,flex:O,datepicker:K,date:V,span:F};const{RangePicker:C}=N,W=({params:c,setParams:u})=>{const[p,b]=h.exports.useState([]);D(()=>{let t={...c};t.gift_card_number=p,u(t)},500,[p]);const d=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.issued_time_from=l,n.issued_time_from=f}else n.issued_time_from="",n.issued_time_to="";u(n)},g=t=>{var _,m,i,s,e,o;let n={...c};if(t){let l=new Date((_=t[0])==null?void 0:_.$y,(m=t[0])==null?void 0:m.$M,(i=t[0])==null?void 0:i.$D).getTime()/1e3,f=new Date((s=t[1])==null?void 0:s.$y,(e=t[1])==null?void 0:e.$M,(o=t[1])==null?void 0:o.$D).getTime()/1e3;n.used_time_from=l,n.used_time_to=f}else n.used_time_from="",n.used_time_to="";u(n)};return r("div",{className:w.container,id:"changeHere",children:r($,{children:a("div",{className:w.formcolumn,children:[a("label",{children:["Gift Card Number",r(k,{onChange:t=>b(t.target.value)})]}),a("label",{children:["Gift Card Issue Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>d(t)})})]}),a("label",{children:["Gift Card Used Date ",r("br",{}),r("div",{style:{display:"flex"},children:r(C,{onChange:t=>g(t)})})]})]})})})},J="_product_info_sw05v_1",Q="_product_name_sw05v_9",X="_icons_sw05v_19",Y="_order_status_sw05v_51",Z="_gross_total_sw05v_59",tt="_openSpinner_sw05v_67",et="_closeSpinner_sw05v_75",rt="_positionabsolute_sw05v_83",ot="_print_sw05v_95",nt="_margintop_sw05v_103",v={product_info:J,product_name:Q,icons:X,order_status:Y,gross_total:Z,openSpinner:tt,closeSpinner:et,positionabsolute:rt,print:ot,margintop:nt},it=({giftData:c,loading:u,handleScroll:p})=>{const b=I(),[d,g]=h.exports.useState(!1),t=h.exports.useRef(),n=T();h.exports.useEffect(()=>{var e;return(e=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||e.addEventListener("scroll",p),()=>{var o;(o=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||o.removeEventListener("scroll",p)}},[]);const _=e=>{const o=new Date(parseInt(e)*1e3),l=o.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),f=o.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return l+", "+f},m=[{title:"Used date",dataIndex:"used_date",key:"order_id",render:e=>_(e)},{title:"Customer email",dataIndex:"email",key:"email",render:(e,o)=>r("a",{children:e})},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Order ID",dataIndex:"order_id",render:(e,o)=>a("div",{onClick:()=>n(`/Orders/orders details/${o.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",e]})},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card amount used",dataIndex:"gift_card_amount_used",key:"gift_card_amount_used",render:e=>a("div",{children:[" \u0930\u0941",e]})},{title:"Gift card number",dataIndex:"gift_card_number",key:"gift_card_number",render:(e,o)=>r("a",{children:e})}],i=G.exports.useReactToPrint({content:()=>t.current,onAfterPrint:()=>g(!1)}),s=()=>{g(!0);const e=setTimeout(i,10);return()=>clearTimeout(e)};return a("div",{children:[r(x,{id:"reportaccount",columns:m,rowKey:"order_id",loading:u,dataSource:c,pagination:!1,scroll:{y:b.height>670?500:300,x:1200}}),a("div",{className:v.positionabsolute,children:[r(S,{className:v.print,onClick:s,children:"print"}),r(S,{children:r(P,{filename:"Gift_Cards.csv",data:c,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),d&&r("div",{className:v.margintop}),d&&r(x,{id:"reporprintTableaccount1",className:v.printTable,style:{zIndex:-1},columns:m,ref:t,rowKey:"order_id",dataSource:c,pagination:!1})]})},st={gift_card_number:"",issued_time_from:"",issued_time_to:"",used_time_from:"",used_time_to:""},ie=()=>{const[c,u]=h.exports.useState(st),[p,b]=h.exports.useState(!1),{data:d,isLoading:g,isFetchingNextPage:t,fetchNextPage:n}=L(c),_=i=>{const s=i.target.scrollTop+i.target.offsetHeight+100>i.target.scrollHeight;b(s)};let m=h.exports.useMemo(()=>{var s;let i=[];return(s=d==null?void 0:d.pages)==null||s.map(e=>{var o,l;(l=(o=e==null?void 0:e.data)==null?void 0:o.report)==null||l.map(f=>{i.push(f)})}),i||[]},[d]);return D(()=>{!p||n()},300,[p]),a("div",{className:A.container,children:[a(y,{children:[r(y.Item,{children:"Reports"}),r(y.Item,{children:"Gift Cards"})]}),r(W,{params:c,setParams:u}),r(it,{giftData:m,loading:g||t,handleScroll:_})]})};export{ie as default};
