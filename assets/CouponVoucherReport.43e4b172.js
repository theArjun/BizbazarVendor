import{r as u,b as o,j as s,aU as k,a as T}from"./index.774ea3ea.js";import{u as C}from"./useDebounce.1afc85d0.js";import{C as z}from"./index.debb8753.js";import{I as N}from"./index.39e4b2c8.js";import{S as D}from"./index.f4539c3d.js";import{D as $}from"./index.bcd0b5f4.js";import{l as P,C as L}from"./index.5c6a01cc.js";import{T as S}from"./Table.41afa7f4.js";import{B as I}from"./button.1c6eda25.js";import{T as A}from"./index.d2c69ca5.js";import{a as R}from"./ReportsApi.1ad700b6.js";import{B as x}from"./Breadcrumb.97460a59.js";import"./Dropdown.9bafc5f9.js";import"./useMergedState.18b5b371.js";import"./Overflow.bc908490.js";import"./index.40d7e5d1.js";import"./motion.300408ad.js";import"./isEqual.4659e5de.js";import"./PlusOutlined.4da0bfe2.js";import"./index.0d78aa55.js";import"./Compact.c162d62d.js";import"./TextArea.119a5545.js";import"./statusUtils.d5af00d6.js";import"./EyeOutlined.700862bb.js";import"./SearchOutlined.16cec939.js";import"./pickAttrs.087993c3.js";import"./CheckOutlined.70cf6153.js";import"./DownOutlined.719ce519.js";import"./LoadingOutlined.732e1375.js";import"./PurePanel.f27248d0.js";import"./index.26751f43.js";import"./styleChecker.bcd3295e.js";import"./css.d6e3059f.js";import"./Pagination.43e6bda7.js";import"./LeftOutlined.de95bfb5.js";import"./RightOutlined.e389cfa8.js";import"./useForceUpdate.0ca03680.js";import"./responsiveObserve.84e4b503.js";import"./index.23d5fe28.js";import"./index.15a5cbb2.js";import"./dropdown.adcd444c.js";import"./collapse.bedc836d.js";import"./useFlexGapSupport.f6cd5e9f.js";import"./index.4645b33d.js";import"./apicall.886edec7.js";import"./axios.0a901153.js";import"./config.54eb1656.js";import"./render.66f9535e.js";import"./useNotification.934e0e3b.js";import"./apicall2.e45f6879.js";import"./useInfiniteQuery.esm.23b2a444.js";import"./useQuery.esm.ae6f238b.js";import"./utils.esm.82fab7d4.js";const B="_container_1qg89_1",E={container:B},O="_container_p3h5z_1",V="_search_inputs_p3h5z_9",M="_price_container_p3h5z_21",j="_search_btn_p3h5z_55",q="_form_p3h5z_63",H="_formcolumn_p3h5z_83",U="_dropdownbutton_p3h5z_99",K="_icon_p3h5z_107",W="_flex_p3h5z_133",F="_datepicker_p3h5z_145",G="_date_p3h5z_145",J="_span_p3h5z_161",w={container:O,search_inputs:V,price_container:M,search_btn:j,form:q,formcolumn:H,dropdownbutton:U,icon:K,flex:W,datepicker:F,date:G,span:J};const{RangePicker:Q}=$,X=({params:m,setParams:d,status:h})=>{const[g,v]=u.exports.useState("");C(()=>{let r={...m};r.order_id=g,d(r)},500,[g]);const i=r=>{var f,_,l,n,a,t;let c={...m};if(r){let e=new Date((f=r[0])==null?void 0:f.$y,(_=r[0])==null?void 0:_.$M,(l=r[0])==null?void 0:l.$D).getTime()/1e3,p=new Date((n=r[1])==null?void 0:n.$y,(a=r[1])==null?void 0:a.$M,(t=r[1])==null?void 0:t.$D).getTime()/1e3;c.date=`time_from=${e}&time_to=${p}`}else c.date="test=9";d(c)};return o("div",{className:w.container,id:"changeHere",children:o(z,{children:s("div",{className:w.formcolumn,children:[s("label",{children:["Order ID",o(N,{type:"number",onChange:r=>v(r.target.value)})]}),s("label",{children:[o("div",{children:"Order Status"}),o(D,{allowClear:!0,placeholder:"Search order status",style:{width:"100%"},onChange:r=>{console.log(r);let c={...m};c.status_id=r||"",d(c)},options:h})]}),s("label",{children:["Order date: ",o("br",{}),o("div",{style:{minWidth:"250px"},children:o(Q,{onChange:r=>i(r)})})]})]})})})},Y="_product_info_sw05v_1",Z="_product_name_sw05v_9",tt="_icons_sw05v_19",et="_order_status_sw05v_51",rt="_gross_total_sw05v_59",ot="_openSpinner_sw05v_67",nt="_closeSpinner_sw05v_75",it="_positionabsolute_sw05v_83",at="_print_sw05v_95",st="_margintop_sw05v_103",y={product_info:Y,product_name:Z,icons:tt,order_status:et,gross_total:rt,openSpinner:ot,closeSpinner:nt,positionabsolute:it,print:at,margintop:st},ct=({status:m,couponData:d,loading:h})=>{const g=k(),[v,i]=u.exports.useState(!1),r=u.exports.useRef(),c=T(),f=t=>{const[e]=m.filter(p=>p.value===t);return o("div",{children:o(A,{className:y.dpContainer,color:e==null?void 0:e.color,children:e==null?void 0:e.label})})},_=t=>{const e=new Date(parseInt(t)*1e3),p=e.toLocaleString("en-US",{year:"numeric",month:"short",day:"2-digit"}),b=e.toLocaleString("en-US",{hour:"2-digit",minute:"numeric"});return p+", "+b},l=[{title:"Order Id",dataIndex:"order_id",key:"status_id",render:(t,e)=>s("div",{onClick:()=>c(`/Orders/orders details/${e.order_id}`),style:{color:"blue",cursor:"pointer"},children:["#",t]}),width:140},{title:"Date And Time",dataIndex:"order_date",key:"date",render:t=>_(t)},{title:"Company name",dataIndex:"company_name",key:"company_name",render:(t,e)=>o("div",{children:t})},{title:"Customer",dataIndex:"customer",key:"customer"},{title:"Customer number",dataIndex:"customer_number",key:"customer_number"},{title:"Total order value",dataIndex:"total_order_value",key:"total_order_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Promotion  value",dataIndex:"promotion_value",key:"promotion_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Net order value",dataIndex:"net_order_value",key:"net_order_value",render:t=>s("div",{children:["\u0930\u0941",t]})},{title:"Promotion name",dataIndex:"promotion_value",key:"promotion_value"},{title:"Order status",dataIndex:"status_id",key:"status_id",render:t=>f(t)}],n=P.exports.useReactToPrint({content:()=>r.current,onAfterPrint:()=>i(!1)}),a=()=>{i(!0);const t=setTimeout(n,10);return()=>clearTimeout(t)};return s("div",{children:[o(S,{id:"reportaccount",columns:l,rowKey:"order_id",loading:h,dataSource:d,pagination:!1,scroll:{y:g.height>670?500:300,x:1800}}),s("div",{className:y.positionabsolute,children:[o(I,{className:y.print,onClick:a,children:"print"}),o(I,{children:o(L,{filename:"Expense_Table.csv",data:d,className:"btn btn-primary",onClick:()=>{},children:"Export to CSV"})})]}),v&&o("div",{className:y.margintop}),v&&o(S,{id:"reporprintTableaccount1",className:y.printTable,style:{zIndex:-1},columns:l,ref:r,rowKey:"order_id",dataSource:d,pagination:!1})]})},dt={order_id:"",date:"",status_id:"",page:1},de=()=>{const[m,d]=u.exports.useState(dt),[h,g]=u.exports.useState(!1),{isLoading:v,data:i,isFetchingNextPage:r,fetchNextPage:c}=R(m);u.exports.useEffect(()=>{var n;return(n=document.querySelector("#reportaccount > div > div.ant-table-body"))==null||n.addEventListener("scroll",l),()=>{var a;(a=document.querySelector("#reportaccount > div > div.ant-table-body "))==null||a.removeEventListener("scroll",l)}},[]);let f=u.exports.useMemo(()=>{var a;let n=[];return(a=i==null?void 0:i.pages)==null||a.map(t=>{var e,p;(p=(e=t==null?void 0:t.data)==null?void 0:e.report)==null||p.map(b=>{n.push(b)})}),n||[]},[i]);const _=()=>{var n,a;if(i!=null&&i.pages){let t=[...(a=(n=i==null?void 0:i.pages)==null?void 0:n.at(-1).data)==null?void 0:a.order_status];return t==null?void 0:t.map((e,p)=>{var b;return{label:e==null?void 0:e.description,value:e==null?void 0:e.status_id,color:(b=e==null?void 0:e.params)==null?void 0:b.color}})}return[]},l=n=>{const a=n.target.scrollTop+n.target.offsetHeight+100>n.target.scrollHeight;g(a)};return C(()=>{!h||c()},300,[h]),s("div",{className:E.container,children:[s(x,{children:[o(x.Item,{children:"Reports"}),o(x.Item,{children:"Coupon Voucher Reports"})]}),o(X,{params:m,setParams:d,status:_()}),o(ct,{couponData:f,status:_(),loading:v||r})]})};export{de as default};
