import{r as u,aU as R,b as t,j as i,F as A}from"./index.0eae6df2.js";import{s as n}from"./Promotion.module.b34b1af2.js";import{u as E}from"./useDebounce.2d8db3a6.js";import{M as B}from"./index.faab0a1d.js";import{I as D}from"./index.e0155dc4.js";import{C as M}from"./index.db80b566.js";import{I as q}from"./index.d5e41f1d.js";import{T as L}from"./Table.c3ea0e52.js";import{d as z}from"./PromotionApi.ddf8bfc2.js";import{B as I}from"./Breadcrumb.3e55c3b1.js";import{B as F}from"./button.bb92e4e7.js";import"./render.36f71972.js";import"./index.bbe2afa4.js";import"./pickAttrs.8c22c2db.js";import"./motion.25de7d91.js";import"./isEqual.7557051f.js";import"./useMergedState.e128dcb1.js";import"./index.a53e5976.js";import"./useFlexGapSupport.26f67e3e.js";import"./index.ae11ed19.js";import"./Compact.394e1fff.js";import"./TextArea.79f23aac.js";import"./index.00b7436e.js";import"./statusUtils.bdd687b0.js";import"./EyeOutlined.e2533ce1.js";import"./SearchOutlined.83cc36da.js";import"./index.ed0030b1.js";import"./css.d6e3059f.js";import"./LeftOutlined.3acbf618.js";import"./RightOutlined.44374471.js";import"./styleChecker.c2755425.js";import"./index.c17da8cc.js";import"./Overflow.0bb1c80c.js";import"./CheckOutlined.aebd02a2.js";import"./DownOutlined.0d88a6a7.js";import"./LoadingOutlined.8c764613.js";import"./PurePanel.6b30b4ea.js";import"./Pagination.e850c34f.js";import"./useForceUpdate.36181d63.js";import"./responsiveObserve.b22e885b.js";import"./dropdown.04f8b523.js";import"./Dropdown.a44dcf86.js";import"./collapse.d7e28f1d.js";import"./index.7079f3c0.js";import"./apiConfig.422f7f8e.js";import"./axios.0a901153.js";import"./config.a608364a.js";import"./useNotification.b0fd12ef.js";import"./useMutation.esm.b9a3c183.js";import"./utils.esm.9d23a50b.js";import"./useInfiniteQuery.esm.39b60b71.js";import"./useQuery.esm.a226e4a2.js";const j="_relative_ora10_1",H="_absolute_ora10_9",K="_tableRow_ora10_39",O="_tableRow1_ora10_47",Q="_checkbox_ora10_69",T="_tableContain_ora10_77",G="_remove_ora10_91",U="_product_name_ora10_97",W="_variation_modal_ora10_105",s={relative:j,absolute:H,tableRow:K,tableRow1:O,checkbox:Q,tableContain:T,remove:G,product_name:U,variation_modal:W},X=({modalOpen:a,setModalOpen:b,productData:C})=>{const[d,x]=u.exports.useState([]),[h,c]=u.exports.useState([]),[_,v]=u.exports.useState(""),m=u.exports.useRef(),g=R(),o=e=>{m.current&&!m.current.contains(e.target)&&v("")};u.exports.useEffect(()=>(document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}),[]);const y=async()=>{c(C)};E(()=>{y()},100,[_]);const N=(e,r)=>{if(e.target.checked&&x([...d,{...r,quantity:1,discountedPrice:0,value:0,discount:"Rs"}]),!e.target.checked){let l=[...d];l=l.filter((p,S)=>p.product_id!=r.product_id),x(l)}},k=e=>{switch(e){case"H":return"Hidden";case"A":return"Active";case"D":return"Disabled";case"R":return"Requires Approval";case"X":return"Disapproved";default:return"Attention required"}},P=(e,r)=>!!e.map((p,S)=>p.product_id).includes(r.product_id),f=[{title:"Name/Code",dataIndex:"name",render:(e,r)=>t(A,{children:i("div",{className:s.product_name,children:[t("h4",{children:r==null?void 0:r.product}),t("p",{children:r==null?void 0:r.product_code})]})})},{title:"Price",dataIndex:"price"},{title:"Quantity",dataIndex:"amount"},{title:"Status",dataIndex:"status",render:e=>t("div",{children:k(e)})}];return t(B,{title:"Add products",centered:!0,open:a,className:s.variation_modal,onOk:()=>b(!1),onCancel:()=>b(!1),width:1e3,children:i("div",{className:s.tabcontain,children:[i("div",{children:[t("h2",{children:"Promotion products"}),i("div",{ref:m,className:s.relative,children:[t(D,{placeholder:"Search Product",type:"text",onFocus:()=>v(" "),value:_,onChange:e=>v(e.target.value)}),_.length>0&&t("div",{className:s.absolute,children:h==null?void 0:h.map((e,r)=>{var l,p;return i("div",{className:s.tableRow,children:[t(M,{checked:P(d,e),className:s.checkbox,onChange:S=>N(S,e)}),t(q,{width:50,src:(p=(l=e==null?void 0:e.main_pair)==null?void 0:l.detailed)==null?void 0:p.image_path}),i("div",{style:{marginLeft:"10px"},children:[t("div",{children:e.product}),t("div",{children:e.product_id})]})]},r)})})]})]}),t("div",{}),t("div",{className:s.tableContain,children:t(L,{rowKey:"product_id",dataSource:d,columns:f,pagination:!1,scroll:{y:g.height>670?300:200,x:1e3}})})]})})},Wt=({data:a,loading:b})=>{var m;const[C,d]=u.exports.useState(!1),x=R(),{isLoading:h,data:c}=z(),_=(g="")=>{var o,y;try{let k=String(g).slice(9).split(",");return(y=(o=c==null?void 0:c.data)==null?void 0:o.products)==null?void 0:y.filter((f,e)=>k.includes(String(f==null?void 0:f.product_id)))}catch(N){console.log("Error  has occured",N)}},v=[{title:"Name/Code",dataIndex:"name",render:(g,o)=>t(A,{children:i("div",{className:n.product_name,children:[t("h4",{children:o==null?void 0:o.product}),t("p",{children:o==null?void 0:o.product_code})]})})},{title:"Price",dataIndex:"price"},{title:"Quantity",dataIndex:"amount"},{title:"Status",dataIndex:"status"}];return i("div",{className:n.container.admin_promotion,children:[t("div",{className:n.breadcrumb,children:i(I,{children:[t(I.Item,{children:"Marketing"}),t(I.Item,{children:t("a",{href:"",children:"Edit Catalog Promotion"})})]})}),t("div",{className:n.top_section,children:t("div",{className:n.promotion_name,children:t("p",{children:a==null?void 0:a.name})})}),t("div",{}),i("div",{className:n.promotion_body,children:[t("div",{className:n.add_btn,children:i(F,{type:"primary",onClick:()=>d(!0),children:[" ","Add products"]})}),t("div",{className:n.tableContain,children:t(L,{loading:h||b,rowKey:"product_id",dataSource:_(a==null?void 0:a.conditions_hash),columns:v,pagination:!1,scroll:{y:x.height>670?300:200,x:1e3}})})]}),t(X,{modalOpen:C,setModalOpen:d,productData:(m=c==null?void 0:c.data)==null?void 0:m.products})]})};export{Wt as default};
